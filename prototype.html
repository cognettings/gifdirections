<!DOCTYPE html>
<html>
<head>
	<meta charset='utf-8'>
	<title>Autopilot</title>
	<link rel='stylesheet' type='text/css' href='css/index.css'></style>
	<script src='js/GifDirections.js'></script>
	<script>
		window.onload = function () {
			app.init();
		};
		
		var app = (function () {
			// Properties
			var _originElement;
			var _destinationElement;
			var _timePerFrameElement;
			var _granularityElement;
			var _imageSizeElement;
			var _overlayDirectionsElement;
			var _getDirectionsButton;
		    var _generateGifButton;
			
			/**
			 * Add event listeners to the page.
			 */
			function _addEventListeners() {
				_getDirectionsButton.onclick = _getDirections;
				_generateGifButton.onclick = _generateGif;
			}
			
			/**
			 * Request directions from Google Maps API.
			 */
			function _getDirections() {
				console.log('getting directions');
			}
			
            /**
             * Use gifDirections module to create the directions GIF.
             */
			function _generateGif() {
				var options = _getOptions();
				
                gifDirections.genDirectionsGif(options, function (gif) {
                    console.log('gif:');
                    console.log(gif);
                });
			}
                
			
			/**
			 * Get user options from the page.
			 */
			function _getOptions() {
				// BUG: .value isn't working
				var options = {};
                
                options.origin = (_originElement.value == "") ? null : _originElement.value;
                options.destination = (_destinationElement.value == "") ? null : _destinationElement.value;
                options.granularity = (_granularityElement.value == "") ? null : _granularityElement.value;
                options.imageSize = (_imageSizeElement.value == "") ? null : _imageSizeElement.value;
                options.overlayDirections = _overlayDirectionsElement.checked;
                options.timePerDirectionFrame = (_timePerFrameElement.value == "") ? null : _timePerFrameElement.value * 2;
                options.timePerFrame = (_timePerFrameElement.value == "") ? null : _timePerFrameElement.value;
                
                return options;
			}
		
            /**
             * Set up the app.
             */
			function init() {
				_originElement = document.querySelector('#origin');
				_destinationElement = document.querySelector('#destination');
				_timePerFrameElement = document.querySelector('#timePerFrame');
				_granularityElement = document.querySelector('#granularity');
				_imageSizeElement = document.querySelector('#imageSize');
				_overlayDirectionsElement = document.querySelector('#overlayDirections');
				_getDirectionsButton = document.querySelector('#getDirections');
				_generateGifButton = document.querySelector('#generateGif');
				
				_addEventListeners();
			}
			
			return {
				init : init
			};
		})();
	</script>
</head>
<body>
	<h1>Autopilot</h1>
	<div id='map'></div>
	<section id='input'>
		<section id='directionsInput'>
			<h3>Directions</h3>
			Start:
			<input id='origin' type='text'>
			<br>
			End:
			<input id='destination' type='text'>
			<br>
			<input id='getDirections' type='button' value='Get directions'>
		</section>
		
		<section id='generationInput'>
			<h3>Generation</h3>
			
			Time per frame (ms):
			<input id='timePerFrame' type='text'>
			<br>
			
			Granularity:
			<select id='granularity'>
				<option value='low'>low</option>
				<option value='medium'>medium</option>
				<option value='high'>high</option>
            </select>
			<br>
			
			Image size:
			<select id='imageSize'>
				<option value='small'>small</option>
				<option value='medium'>medium</option>
				<option value='large'>large</option>
			</select>
			<br>
			
			Overlay directions
			<input id='overlayDirections' type='checkbox'>
			<br>
			
			<input id='generateGif' type='button' value='Generate GIF'>
		</section>
	</section> <!-- End user input -->
</body>
</html>